<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSC Multi-Year Planner (Final Complete)</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lora:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                        serifText: ['Lora', 'serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        bsc: { green: '#005F40', gold: '#D4AF37' }
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0,0,0,0.05)',
                        'tooltip': '0 4px 6px -1px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F8FAFC; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        
        /* Note Lined Paper */
        .lined-paper {
            background-color: #FDFDFD;
            background-image: linear-gradient(#F1F5F9 1px, transparent 1px); /* Siêu mờ */
            background-size: 100% 36px; line-height: 36px; 
        }
        .lined-input {
            background: transparent; width: 100%; border: none; outline: none; padding: 0; margin: 0;
            font-family: 'Lora', serif; font-size: 15px; color: #334155; line-height: 36px; 
        }
        
        /* Checkbox Custom (Web) */
        .custom-checkbox {
            appearance: none; background-color: #fff; margin: 0; width: 1.15em; height: 1.15em;
            border: 1px solid #cbd5e1; border-radius: 0.15em; display: grid; place-content: center; cursor: pointer;
        }
        .custom-checkbox::before {
            content: ""; width: 0.65em; height: 0.65em; transform: scale(0);
            transition: 120ms transform ease-in-out; box-shadow: inset 1em 1em #005F40;
            transform-origin: center; clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        .custom-checkbox:checked::before { transform: scale(1); }

        /* Print Checkbox */
        .print-checkbox {
            display: none; width: 14px; height: 14px; border: 1px solid #94A3B8; background: white; margin-right: 8px; flex-shrink: 0;
        }

        /* Tooltip */
        .tooltip-group:hover .tooltip-text { visibility: visible; opacity: 1; transform: translateY(0); }
        .tooltip-text { visibility: hidden; opacity: 0; transform: translateY(-4px); transition: all 0.2s; }
        
        /* Filter Pills */
        .filter-pill { transition: all 0.2s; cursor: pointer; user-select: none; }
        .filter-pill.active { opacity: 1; transform: scale(1); box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .filter-pill.inactive { opacity: 0.5; transform: scale(0.98); background-color: #F1F5F9 !important; color: #94A3B8 !important; border-color: #E2E8F0 !important; }

        @media print {
            @page { size: A4 landscape; margin: 0; }
            body { background: white; margin: 0; padding: 0; }
            .no-print { display: none !important; }
            .print-container { 
                width: 100vw; height: 100vh; border: none; box-shadow: none; 
                border-radius: 0; padding: 5mm 10mm; background: white !important;
            }
            .lined-paper { background-image: linear-gradient(#F1F5F9 1px, transparent 1px) !important; }
            .print-checkbox { display: inline-block !important; }
            .custom-checkbox { display: none !important; }
            .note-row { display: flex !important; align-items: center !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ASSETS ---
        const LOGO_BASE64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQBAMAAAAgtay6AAAAJFBMVEVHcEwmYakyZ6MnXKpIa5owX6bcpTwSq5ImXKspXKkRr5D8syaoW6H2AAAACHRSTlMAfEG4Ftu/ypTeOakAAAHmSURBVHic7ZVBTsQgFIafTkxKZjPqBRpPoPESLj0SmpjgjrjrrLqeG0x6OV+BR4ECM0Cixsy/aPnp+/hpYRiAi/6ottOsSnhqgLct8NQAb1vgqQHetsAKHFAHVE3wsRK2wRXwElwBL8GV8LEWJv0mvG+BDw3wvgU+BPCt0p1X1Hvuwbb2ISxI3HR0ytHjjftMs2MENhWdcS5Lz8JgBxa+j7gw2IW5ExxzsPrWAZxyguAxAQsTxYHK9V1ddwaGAN7RIBp+9Jwws+caHqNwZ8vBlhMECwx5mIMtp6Fm96HgMQ5DDjaN1bZewcKD3zx4TMDLO/fG8mUeYGA4Cdt97cAJGZg+rFrTvgAm9dbyYpjT7O3UC2DtXxxXMm2/oxDmXg+vgum9z18qcBd4Uwp3DqyH4ufDejc7ixTZnqdhvrgu+GGUwqIMFhEY7+85uFuVr4+hJGwXxx7YfHUAxmBnf6ryTzqB3aP39TQMOZeFab4pl4V9H3EZWA/eeY5lg1N/7nEX6lnL63vy3H2CvOiHNUgGA+AFm7MZrkDijQ0S29iFYtRYSfYMJArgGu9YiDCywOYBGTwqGL1MJWO1pGTQyQqWJhkGFp+2BIKZToZ5IjYZ+2U+eQA1skr+Ul9Aw/pVmbxJvfNF/1/falRpmEp4VcUAAAAASUVORK5CYII=";

        // --- LUNAR DATA ENGINE (2022-2032) ---
        const LUNAR_ANCHORS = [
            {s:'2022-01-03',m:12},{s:'2022-02-01',m:1},{s:'2022-03-03',m:2},{s:'2022-04-01',m:3},{s:'2022-05-01',m:4},{s:'2022-05-30',m:5},{s:'2022-06-29',m:6},{s:'2022-07-29',m:7},{s:'2022-08-27',m:8},{s:'2022-09-26',m:9},{s:'2022-10-25',m:10},{s:'2022-11-24',m:11},{s:'2022-12-23',m:12},
            {s:'2023-01-22',m:1},{s:'2023-02-20',m:2},{s:'2023-03-22',m:2},{s:'2023-04-20',m:3},{s:'2023-05-19',m:4},{s:'2023-06-18',m:5},{s:'2023-07-18',m:6},{s:'2023-08-16',m:7},{s:'2023-09-15',m:8},{s:'2023-10-15',m:9},{s:'2023-11-13',m:10},{s:'2023-12-13',m:11},
            {s:'2024-01-11',m:12},{s:'2024-02-10',m:1},{s:'2024-03-10',m:2},{s:'2024-04-09',m:3},{s:'2024-05-08',m:4},{s:'2024-06-06',m:5},{s:'2024-07-06',m:6},{s:'2024-08-04',m:7},{s:'2024-09-03',m:8},{s:'2024-10-03',m:9},{s:'2024-11-01',m:10},{s:'2024-12-01',m:11},{s:'2024-12-31',m:12},
            {s:'2025-01-29',m:1},{s:'2025-02-28',m:2},{s:'2025-03-29',m:3},{s:'2025-04-27',m:4},{s:'2025-05-27',m:5},{s:'2025-06-25',m:6},{s:'2025-07-25',m:6},{s:'2025-08-23',m:7},{s:'2025-09-22',m:8},{s:'2025-10-21',m:9},{s:'2025-11-20',m:10},{s:'2025-12-20',m:11},
            {s:'2026-01-19',m:12},{s:'2026-02-17',m:1},{s:'2026-03-19',m:2},{s:'2026-04-17',m:3},{s:'2026-05-17',m:4},{s:'2026-06-15',m:5},{s:'2026-07-15',m:6},{s:'2026-08-13',m:7},{s:'2026-09-11',m:8},{s:'2026-10-11',m:9},{s:'2026-11-09',m:10},{s:'2026-12-09',m:11},
            {s:'2027-01-08',m:12},{s:'2027-02-06',m:1},{s:'2027-03-08',m:2},{s:'2027-04-06',m:3},{s:'2027-05-06',m:4},{s:'2027-06-04',m:5},{s:'2027-07-04',m:6},{s:'2027-08-02',m:7},{s:'2027-08-31',m:8},{s:'2027-09-30',m:9},{s:'2027-10-29',m:10},{s:'2027-11-28',m:11},{s:'2027-12-27',m:12},
            {s:'2028-01-26',m:1},{s:'2028-02-25',m:2},{s:'2028-03-26',m:3},{s:'2028-04-24',m:4},{s:'2028-05-24',m:5},{s:'2028-06-23',m:5},{s:'2028-07-22',m:6},{s:'2028-08-20',m:7},{s:'2028-09-19',m:8},{s:'2028-10-18',m:9},{s:'2028-11-17',m:10},{s:'2028-12-16',m:11},
            {s:'2029-01-15',m:12},{s:'2029-02-13',m:1},{s:'2029-03-15',m:2},{s:'2029-04-13',m:3},{s:'2029-05-13',m:4},{s:'2029-06-11',m:5},{s:'2029-07-11',m:6},{s:'2029-08-09',m:7},{s:'2029-09-08',m:8},{s:'2029-10-07',m:9},{s:'2029-11-06',m:10},{s:'2029-12-05',m:11},
            {s:'2030-01-04',m:12},{s:'2030-02-03',m:1},{s:'2030-03-04',m:2},{s:'2030-04-03',m:3},{s:'2030-05-03',m:4},{s:'2030-06-01',m:5},{s:'2030-07-01',m:6},{s:'2030-07-30',m:6},{s:'2030-08-29',m:7},{s:'2030-09-27',m:8},{s:'2030-10-27',m:9},{s:'2030-11-25',m:10},{s:'2030-12-25',m:11},
            {s:'2031-01-23',m:1},{s:'2031-02-22',m:2},{s:'2031-03-24',m:3},{s:'2031-04-22',m:4},{s:'2031-05-22',m:5},{s:'2031-06-20',m:6},{s:'2031-07-20',m:7},{s:'2031-08-18',m:8},{s:'2031-09-17',m:9},{s:'2031-10-16',m:10},{s:'2031-11-15',m:11},{s:'2031-12-14',m:12},
            {s:'2032-01-13',m:12} 
        ];

        function getLunarDate(dateObj) {
            const currentTs = dateObj.getTime();
            let anchor = null;
            for (let i = 0; i < LUNAR_ANCHORS.length - 1; i++) {
                const currStart = new Date(LUNAR_ANCHORS[i].s).getTime();
                const nextStart = new Date(LUNAR_ANCHORS[i+1].s).getTime();
                if (currentTs >= currStart && currentTs < nextStart) { anchor = LUNAR_ANCHORS[i]; break; }
            }
            if(!anchor && currentTs >= new Date(LUNAR_ANCHORS[LUNAR_ANCHORS.length-1].s).getTime()) { anchor = LUNAR_ANCHORS[LUNAR_ANCHORS.length-1]; }
            if (!anchor) return { day: 1, month: 1 };
            const diffDays = Math.floor((currentTs - new Date(anchor.s).getTime()) / (1000 * 60 * 60 * 24));
            return { day: diffDays + 1, month: anchor.m };
        }

        // --- FULL EVENTS 2026 (Restored) ---
        const EVENTS_2026 = [
            {"date": "2026-01-01", "title": "[Nghỉ Lễ] Tết Dương Lịch 2026", "category": "holiday", "description": "Nghỉ lễ toàn quốc"},
            {"date": "2026-01-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-01-15", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 1"},
            {"date": "2026-01-19", "title": "[VN] ETF: (A) Cập nhật TT", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-01-21", "title": "[VN] ETF: (A) Xem xét định kỳ", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-01-27", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-02-02", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-02-04", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-02-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-02-16", "title": "[Nghỉ Lễ] Tết Nguyên Đán (Dự kiến)", "category": "holiday", "description": "Thị trường nghỉ"},
            {"date": "2026-02-17", "title": "[Nghỉ Lễ] Tết Nguyên Đán (Mùng 1)", "category": "holiday", "description": "Mùng 1 Tết Bính Ngọ"},
            {"date": "2026-02-18", "title": "[Nghỉ Lễ] Tết Nguyên Đán (Mùng 2)", "category": "holiday", "description": "Mùng 2 Tết"},
            {"date": "2026-02-19", "title": "[Nghỉ Lễ] Tết Nguyên Đán (Mùng 3)", "category": "holiday", "description": "Mùng 3 Tết"},
            {"date": "2026-02-20", "title": "[Nghỉ Lễ] Tết Nguyên Đán (Mùng 4)", "category": "holiday", "description": "Mùng 4 Tết"},
            {"date": "2026-02-21", "title": "[Nghỉ Lễ] Tết Nguyên Đán (Mùng 5)", "category": "holiday", "description": "Mùng 5 Tết"},
            {"date": "2026-02-27", "title": "[QT] ETF Ngoại: Cut-off FTSE", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-02-27", "title": "[VN] ETF: (A) Danh mục mới", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-03-05", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-03-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-03-13", "title": "[VN] ETF: (A) Danh mục mới", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-03-17", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-03-19", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 3"},
            {"date": "2026-03-23", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-03-30", "title": "[VN] FTSE: Interim Review (Nâng hạng)", "category": "personal", "description": "Quan trọng: Nâng hạng thị trường"},
            {"date": "2026-03-31", "title": "[VN] ETF Nội: Cut-off Q2", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-04-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-04-15", "title": "[VN] ETF: (A) Cập nhật VNX", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-04-16", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-04-16", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 4"},
            {"date": "2026-04-20", "title": "[VN] ETF: (A) Xem xét định kỳ", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-04-26", "title": "[Nghỉ Lễ] Giỗ Tổ Hùng Vương (10/3)", "category": "holiday", "description": "Nghỉ bù vào Thứ 2"},
            {"date": "2026-04-28", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-04-30", "title": "[Nghỉ Lễ] Giải phóng MN", "category": "holiday", "description": "Nghỉ Lễ"},
            {"date": "2026-05-01", "title": "[Nghỉ Lễ] Quốc tế Lao động", "category": "holiday", "description": "Nghỉ Lễ"},
            {"date": "2026-05-04", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-05-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-05-21", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 5"},
            {"date": "2026-05-29", "title": "[QT] ETF Ngoại: Cut-off", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-06-04", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-06-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-06-12", "title": "[VN] ETF: (A) Danh mục mới", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-06-16", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-06-18", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 6"},
            {"date": "2026-06-22", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-06-30", "title": "[VN] ETF Nội: Cut-off Q3", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-07-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-07-15", "title": "[VN] ETF: (A) Xem xét định kỳ", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-07-16", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-07-16", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 7"},
            {"date": "2026-07-20", "title": "[VN] ETF: (A) Cập nhật VNFIN LEAD", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-07-28", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-08-03", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-08-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-08-20", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 8"},
            {"date": "2026-08-28", "title": "[QT] ETF Ngoại: Cut-off", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-08-31", "title": "[QT] ETF Ngoại: Cut-off MV", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-09-02", "title": "[Nghỉ Lễ] Quốc Khánh 2/9", "category": "holiday", "description": "Nghỉ lễ"},
            {"date": "2026-09-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-09-10", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-09-11", "title": "[VN] ETF: (A) Danh mục mới", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-09-15", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-09-17", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 9"},
            {"date": "2026-09-21", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-09-21", "title": "[VN] FTSE: NÂNG HẠNG (Hiệu lực)", "category": "personal", "description": "Sự kiện đặc biệt: Chính thức nâng hạng"},
            {"date": "2026-09-30", "title": "[VN] ETF Nội: Cut-off Q4", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-10-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-10-15", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 10"},
            {"date": "2026-10-19", "title": "[VN] ETF: (A) Xem xét định kỳ", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-10-21", "title": "[VN] ETF: (A) Cập nhật TT", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-10-27", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-10-28", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-11-02", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Nội"},
            {"date": "2026-11-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-11-19", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 11"},
            {"date": "2026-11-27", "title": "[QT] ETF Ngoại: Cut-off", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-11-30", "title": "[QT] ETF Ngoại: Cut-off MV", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-12-06", "title": "[VN] GSO: Báo cáo KT-XH", "category": "macro_vn", "description": "Nguồn: Tổng cục Thống kê"},
            {"date": "2026-12-08", "title": "[QT] FED: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: FED"},
            {"date": "2026-12-10", "title": "[QT] ECB: Họp CS Tiền tệ", "category": "macro_global", "description": "Nguồn: ECB"},
            {"date": "2026-12-11", "title": "[VN] ETF: (A) Danh mục mới", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-12-17", "title": "[VN] Futures VN30 đáo hạn", "category": "derivatives", "description": "Đáo hạn Phái sinh Tháng 12"},
            {"date": "2026-12-21", "title": "[VN] ETF: (E) Hiệu lực", "category": "etf", "description": "Nguồn: ETF Ngoại"},
            {"date": "2026-12-31", "title": "[VN] ETF Nội: Cut-off Q1/2027", "category": "etf", "description": "Nguồn: ETF Nội"}
        ];

        function generateAutoEvents(year) {
            const evs = [];
            // Derivatives: 3rd Thursday
            for(let m=0; m<12; m++) {
                let d = new Date(year, m, 1); let count = 0;
                while(d.getMonth() === m) {
                    if(d.getDay() === 4) { count++; if(count === 3) { evs.push({ date: `${year}-${String(m+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`, title: `[VN] Futures Đáo hạn T${m+1}`, category: 'derivatives' }); break; } }
                    d.setDate(d.getDate() + 1);
                }
            }
            // Holidays
            evs.push({date:`${year}-01-01`, title:"[Nghỉ Lễ] Tết Dương Lịch", category:'holiday'});
            evs.push({date:`${year}-04-30`, title:"[Nghỉ Lễ] Giải phóng MN", category:'holiday'});
            evs.push({date:`${year}-05-01`, title:"[Nghỉ Lễ] Quốc tế Lao động", category:'holiday'});
            evs.push({date:`${year}-09-02`, title:"[Nghỉ Lễ] Quốc khánh", category:'holiday'});
            // Lunar Holidays
            let start = new Date(year, 0, 1);
            let end = new Date(year, 11, 31);
            for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
                const l = getLunarDate(d);
                const dStr = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
                if (l.month === 1 && l.day === 1) evs.push({date:dStr, title:"[Nghỉ Lễ] Tết Nguyên Đán", category:'holiday'});
                if (l.month === 3 && l.day === 10) evs.push({date:dStr, title:"[Nghỉ Lễ] Giỗ Tổ Hùng Vương", category:'holiday'});
            }
            return evs;
        }

        // --- HELPERS ---
        const CATEGORIES = [
            { id: 'all', label: 'Tất cả', color: 'bg-slate-800 text-white border-slate-800' },
            { id: 'holiday', label: 'Lễ Tết', color: 'bg-rose-100 text-rose-700 border-rose-200' },
            { id: 'macro_global', label: 'Vĩ mô TG', color: 'bg-indigo-100 text-indigo-700 border-indigo-200' },
            { id: 'macro_vn', label: 'Vĩ mô VN', color: 'bg-emerald-100 text-emerald-700 border-emerald-200' },
            { id: 'etf', label: 'ETF', color: 'bg-slate-100 text-slate-700 border-slate-200' },
            { id: 'derivatives', label: 'Phái sinh', color: 'bg-amber-100 text-amber-700 border-amber-200' },
            { id: 'personal', label: 'Cá nhân', color: 'bg-sky-100 text-sky-700 border-sky-200' }
        ];
        const getCatStyle = (cat) => CATEGORIES.find(c => c.id === cat)?.color || 'bg-gray-100 text-gray-600';
        const getSmartBadge = (title) => {
            let s = title.replace(/\[VN\]|\[QT\]|\[Nghỉ Lễ\]/g, '').trim();
            if(s.includes('FED')) return 'FED: Policy'; if(s.includes('ECB')) return 'ECB: Policy';
            if(s.includes('GSO') && s.includes('GDP')) return 'GSO: GDP (Q)'; if(s.includes('GSO')) return 'GSO: Macro';
            if(s.includes('Futures')) return 'PS: Đáo Hạn'; if(s.includes('ETF') && (s.includes('Review') || s.includes('Cập nhật'))) return 'ETF: Review';
            if(s.includes('Hiệu lực') || s.includes('Effective')) return 'ETF: Effective'; if(s.length > 18) return s.substring(0, 18) + '..';
            return s;
        };
        const Icons = {
            Plus: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 4v16m8-8H4"></path></svg>,
            Trash: () => <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>,
            Print: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg>,
            Save: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>,
            Upload: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>,
            Left: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7"/></svg>,
            Right: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 5l7 7-7 7"/></svg>,
            X: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"/></svg>,
            Help: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8.257 3.099c1.765-2.052 5.174-2.052 6.939 0 1.875 2.18 2.146 5.483 1.05 7.962-1.026 2.316-2.585 3.33-2.585 5.518v.794a.75.75 0 01-1.5 0v-.853c0-2.887 1.956-3.882 2.946-6.108.835-1.877.625-4.225-.794-5.877-1.314-1.528-3.83-1.528-5.144 0-1.42 1.651-1.63 3.999-.795 5.877.348.784.025 1.706-.723 2.054a.75.75 0 01-1.028-.354c-1.11-2.48-.824-5.782 1.05-7.962zM12 20.25a1.125 1.125 0 100-2.25 1.125 1.125 0 000 2.25z"/></svg>,
        };

        const TooltipBtn = ({ icon, text, onClick, label, className, isHelp = false }) => (
            <div className={`relative tooltip-group ${isHelp ? '' : 'inline-block'}`}>
                {label ? (
                    <label className={`flex items-center gap-2 px-3 py-2 text-xs font-medium border rounded-lg transition cursor-pointer ${className}`}>
                        {icon} {text}
                        <input type="file" className="hidden" accept=".json" onChange={onClick} />
                    </label>
                ) : (
                    <button onClick={onClick} className={`flex items-center justify-center gap-2 transition ${isHelp ? 'w-8 h-8 rounded-full border border-slate-300 text-slate-500 hover:bg-slate-50' : `px-3 py-2 text-xs font-medium border rounded-lg ${className}`}`}>
                        {icon} {text}
                    </button>
                )}
                <div className="tooltip-text absolute top-full right-0 mt-2 px-3 py-1.5 bg-slate-800 text-white text-[10px] rounded shadow-tooltip whitespace-nowrap z-20">
                    {text === '?' ? 'Hướng dẫn' : text}
                </div>
            </div>
        );

        // --- MAIN APP ---
        function App() {
            const [currentDate, setCurrentDate] = useState(new Date(2026, 0, 1));
            const [customEvents, setCustomEvents] = useState([]);
            const [notes, setNotes] = useState(() => Array(10).fill(null).map((_, i) => ({ id: i, text: '', done: false })));
            const [selectedEvent, setSelectedEvent] = useState(null);
            const [isAddModalOpen, setIsAddModalOpen] = useState(false);
            const [isHelpOpen, setIsHelpOpen] = useState(false);
            const [newEvent, setNewEvent] = useState({ date: '', title: '' });
            const [filters, setFilters] = useState(['holiday', 'macro_global', 'macro_vn', 'etf', 'derivatives', 'personal']);

            useEffect(() => {
                const e = localStorage.getItem('planner_ev_v3');
                const n = localStorage.getItem('planner_nt_v3');
                if (e) setCustomEvents(JSON.parse(e));
                if (n) setNotes(JSON.parse(n));
            }, []);
            useEffect(() => {
                localStorage.setItem('planner_ev_v3', JSON.stringify(customEvents));
                localStorage.setItem('planner_nt_v3', JSON.stringify(notes));
            }, [customEvents, notes]);

            const toggleFilter = (cat) => {
                if (cat === 'all') setFilters(CATEGORIES.map(c=>c.id).filter(id=>id!=='all'));
                else if (filters.includes(cat)) setFilters(filters.filter(f => f !== cat));
                else setFilters([...filters, cat]);
            };

            const displayEvents = useMemo(() => {
                const year = currentDate.getFullYear();
                let yearEvents = (year === 2026) ? [...EVENTS_2026] : generateAutoEvents(year);
                const all = [...yearEvents, ...customEvents];
                return all.filter(e => filters.includes(e.category));
            }, [currentDate, customEvents, filters]);

            const handleMonthChange = (dir) => {
                const newDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + dir, 1);
                if(newDate.getFullYear() >= 2022 && newDate.getFullYear() <= 2032) setCurrentDate(newDate);
            };

            const handleDeleteCustomEvent = (id) => { 
                if(window.confirm("Xóa sự kiện này?")) {
                    setCustomEvents(prev => prev.filter(e => e.id !== id));
                    setSelectedEvent(null);
                }
            };

            const handleRestore = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (evt) => {
                    try { const d = JSON.parse(evt.target.result); if(d.events) setCustomEvents(d.events); if(d.notes) setNotes(d.notes); alert("Khôi phục thành công!"); }
                    catch(e){alert("File lỗi!");}
                };
                reader.readAsText(file);
            };

            const year = currentDate.getFullYear(); 
            const month = currentDate.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const firstDay = (new Date(year, month, 1).getDay() + 6) % 7; 
            const days = Array(firstDay).fill(null).concat(Array.from({length: daysInMonth}, (_, i) => new Date(year, month, i + 1)));

            return (
                <div className="w-full min-h-screen flex flex-col items-center py-8 print:p-0">
                    <div className="print-container w-[1200px] bg-[#FDFDFD] shadow-soft rounded-xl overflow-hidden flex flex-col border border-slate-200">
                        {/* HEADER */}
                        <header className="px-8 py-4 flex justify-between items-center border-b border-slate-100 bg-white no-print">
                            <div className="flex items-center gap-4"><img src={LOGO_BASE64} alt="BSC" className="h-10 w-auto object-contain" /><div className="h-8 w-px bg-slate-200 mx-2"></div><div><h1 className="font-serif text-xl font-bold text-slate-800 leading-none">Planner {year}</h1><p className="font-mono text-[10px] text-slate-400 mt-1 uppercase tracking-widest">Financial Research</p></div></div>
                            <div className="flex gap-2">
                                <TooltipBtn icon={<Icons.Plus />} text="Add" onClick={() => setIsAddModalOpen(true)} className="text-slate-600 hover:bg-slate-50 border-slate-200" />
                                <div className="flex gap-1.5 border border-slate-200 p-1 rounded-lg bg-slate-50">
                                    <TooltipBtn icon={<Icons.Upload />} text="Restore" onClick={handleRestore} label={true} className="text-slate-600 hover:bg-white border-transparent" />
                                    <TooltipBtn icon={<Icons.Save />} text="Backup" onClick={() => { const blob = new Blob([JSON.stringify({events: customEvents, notes})], {type:'application/json'}); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download=`BSC_Planner_${year}.json`; a.click(); }} className="text-slate-600 hover:bg-white border-transparent" />
                                </div>
                                <TooltipBtn icon={<Icons.Print />} text="Print" onClick={() => window.print()} className="bg-[#005F40] text-white hover:bg-[#004d34] border-transparent" />
                                <TooltipBtn icon={<Icons.Help />} text="?" onClick={() => setIsHelpOpen(true)} isHelp={true} />
                            </div>
                        </header>
                        
                        {/* FILTER */}
                        <div className="px-8 py-3 bg-slate-50 border-b border-slate-100 flex items-center gap-2 no-print overflow-x-auto">
                            <span className="text-[10px] font-mono text-slate-400 uppercase mr-2">Show:</span>
                            <div onClick={() => toggleFilter('all')} className={`filter-pill px-3 py-1 rounded-full text-[10px] font-bold border ${filters.length >= 6 ? 'bg-slate-800 text-white' : 'bg-white text-slate-500'}`}>Tất cả</div>
                            {CATEGORIES.filter(c => c.id !== 'all').map(cat => (<div key={cat.id} onClick={() => toggleFilter(cat.id)} className={`filter-pill px-3 py-1 rounded-full text-[10px] font-bold border ${filters.includes(cat.id) ? cat.color : 'inactive'}`}>{cat.label}</div>))}
                        </div>

                        {/* PRINT HEADER */}
                        <div className="hidden print:flex px-8 py-6 justify-between items-center border-b border-slate-100"><img src={LOGO_BASE64} alt="BSC Logo" className="h-12 w-auto object-contain" /><div className="text-right"><h1 className="font-serif text-2xl font-bold text-slate-800">Planner {year}</h1><p className="font-sans text-xs text-slate-500">BSC Securities • Research Dept</p></div></div>

                        {/* BODY */}
                        <div className="flex-1 flex overflow-hidden">
                            {/* CALENDAR */}
                            <div className="flex-[2] border-r border-slate-200 flex flex-col p-6 bg-white">
                                <div className="flex justify-between items-end mb-4">
                                    <div><h2 className="text-3xl font-serif font-bold text-slate-900 capitalize">{currentDate.toLocaleString('vi-VN', { month: 'long' })}</h2><p className="text-lg font-serif italic text-slate-400">{year}</p></div>
                                    <div className="flex gap-2 no-print"><button onClick={() => handleMonthChange(-1)} className="p-1.5 hover:bg-slate-100 rounded-full text-slate-400"><Icons.Left /></button><button onClick={() => handleMonthChange(1)} className="p-1.5 hover:bg-slate-100 rounded-full text-slate-400"><Icons.Right /></button></div>
                                </div>
                                {year !== 2026 && <div className="mb-2 px-3 py-1.5 bg-yellow-50 text-yellow-700 text-xs rounded border border-yellow-100 no-print flex items-center">⚠️ Sự kiện Vĩ mô/ETF năm {year} chưa có dữ liệu chi tiết. Chỉ hiển thị Lễ Tết & Phái sinh.</div>}
                                <div className="grid grid-cols-7 mb-2 border-b border-slate-100 pb-2">{['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].map(d => <div key={d} className="text-center font-mono text-[10px] font-bold text-slate-400 uppercase tracking-widest">{d}</div>)}</div>
                                <div className="flex-1 grid grid-cols-7 auto-rows-fr gap-px bg-slate-100 border border-slate-100">
                                    {days.map((d, i) => {
                                        if (!d) return <div key={i} className="bg-white"></div>;
                                        const dStr = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
                                        const evs = displayEvents.filter(e => e.date === dStr);
                                        const isHoliday = evs.some(e => e.category === 'holiday');
                                        const lunar = getLunarDate(d);
                                        const isMajor = lunar.day === 1 || lunar.day === 15;
                                        const isToday = new Date().toDateString() === d.toDateString();
                                        return (
                                            <div key={i} className={`${isHoliday ? 'bg-rose-50' : 'bg-white'} p-1.5 flex flex-col group hover:bg-slate-50 min-h-[80px]`}>
                                                <div className="flex justify-between items-baseline mb-1">
                                                    <span className={`font-mono text-base leading-none ${isToday ? 'text-[#005F40] font-bold' : (isHoliday ? 'text-rose-700 font-bold' : 'text-slate-700')}`}>{d.getDate()}</span>
                                                    <div className="flex items-center gap-0.5">{isMajor && <div className="w-1.5 h-1.5 rounded-full bg-[#D4AF37]"></div>}<span className={`font-serif text-[9px] ${isMajor ? 'text-[#B4941F] font-bold' : 'text-slate-400'}`}>{lunar.day}/{lunar.month}</span></div>
                                                </div>
                                                <div className="flex flex-col gap-0.5 overflow-hidden">
                                                    {evs.filter(e => e.category !== 'holiday').slice(0, 4).map(ev => (<div key={ev.title+i} onClick={() => setSelectedEvent({...ev, lunarStr: `${lunar.day}/${lunar.month}`, id: ev.id})} className={`truncate text-[9px] px-1 rounded-sm border-l-2 cursor-pointer font-medium leading-tight py-0.5 ${getCatStyle(ev.category)}`}>{getSmartBadge(ev.title)}</div>))}
                                                    {isHoliday && evs.filter(e => e.category === 'holiday').map(ev => (<div key={ev.title} className="text-[9px] text-rose-600 font-serif italic truncate mt-auto">{getSmartBadge(ev.title)}</div>))}
                                                </div>
                                            </div>
                                        )
                                    })}
                                </div>
                            </div>

                            {/* NOTES */}
                            <div className="flex-1 bg-[#FDFDFD] flex flex-col relative print:border-none">
                                <div className="px-8 pt-6 pb-4 flex justify-between items-end"><div><h3 className="font-serif font-bold text-xl text-slate-800">Notes</h3><p className="font-mono text-[10px] text-slate-400 uppercase tracking-widest mt-0.5">Priority & Tasks</p></div><button onClick={() => setNotes([{id: Date.now(), text:'', done:false}, ...notes])} className="no-print p-1.5 bg-slate-100 hover:bg-[#005F40] hover:text-white rounded transition"><Icons.Plus /></button></div>
                                <div className="flex-1 lined-paper px-8 overflow-y-auto">
                                    {notes.map(note => (
                                        <div key={note.id} className="group note-row flex items-center w-full h-[36px] gap-3 relative">
                                            <input type="checkbox" checked={note.done} onChange={e => setNotes(notes.map(n => n.id===note.id ? {...n, done:e.target.checked} : n))} className="custom-checkbox no-print" />
                                            <span className="print-checkbox hidden"></span>
                                            <input className={`lined-input ${note.done ? 'line-through text-slate-300' : ''}`} value={note.text} onChange={e => setNotes(notes.map(n => n.id===note.id ? {...n, text:e.target.value} : n))} />
                                            <button onClick={() => setNotes(notes.filter(n => n.id !== note.id))} className="no-print absolute right-0 opacity-0 group-hover:opacity-100 text-slate-300 hover:text-rose-500 px-2"><Icons.Trash /></button>
                                        </div>
                                    ))}
                                    {Array(15).fill(0).map((_, i) => <div key={i} className="w-full h-[36px] print:block hidden"></div>)}
                                </div>
                                <div className="p-4 text-center"><p className="font-mono text-[9px] text-slate-300">© 2026 BSC Research</p></div>
                            </div>
                        </div>
                    </div>

                    {/* MODALS */}
                    {selectedEvent && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm p-4 no-print" onClick={() => setSelectedEvent(null)}>
                            <div className="bg-white w-full max-w-sm rounded-xl shadow-2xl overflow-hidden" onClick={e => e.stopPropagation()}>
                                <div className={`p-5 ${getCatStyle(selectedEvent.category).split(' ')[0]} bg-opacity-20`}>
                                    <div className="flex justify-between items-start"><span className="text-[10px] font-bold uppercase tracking-wider bg-white/80 px-2 py-0.5 rounded text-slate-700">{selectedEvent.category}</span><button onClick={() => setSelectedEvent(null)} className="text-slate-600"><Icons.X /></button></div>
                                    <h3 className="font-serif font-bold text-lg text-slate-900 mt-2">{selectedEvent.title}</h3>
                                </div>
                                <div className="p-5">
                                    <div className="flex gap-4 mb-4">
                                        <div className="flex-1 p-2 bg-slate-50 rounded border border-slate-100 text-center"><div className="text-[10px] text-slate-400 uppercase">Ngày</div><div className="font-bold text-slate-800">{selectedEvent.date}</div></div>
                                        <div className="flex-1 p-2 bg-[#D4AF37]/10 rounded border border-[#D4AF37]/30 text-center"><div className="text-[10px] text-[#B4941F] uppercase">Âm Lịch</div><div className="font-bold text-[#D4AF37] font-serif">{selectedEvent.lunarStr}</div></div>
                                    </div>
                                    <p className="text-sm text-slate-600 font-serif mb-6">{selectedEvent.desc || selectedEvent.description}</p>
                                    
                                    <div className="flex gap-2">
                                        <button onClick={() => { setNotes([{id: Date.now(), text: `[${selectedEvent.date}] ${selectedEvent.title}`, done: false}, ...notes]); setSelectedEvent(null); }} className="flex-1 py-2 bg-[#005F40] text-white rounded-lg text-sm font-medium hover:bg-[#004d34] shadow-lg shadow-[#005F40]/20">+ Add to Notes</button>
                                        {selectedEvent.category === 'personal' && <button onClick={() => handleDeleteCustomEvent(selectedEvent.id)} className="px-3 py-2 bg-rose-100 text-rose-700 rounded-lg hover:bg-rose-200"><Icons.Trash /> Xóa</button>}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                    {isAddModalOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm p-4 no-print">
                            <div className="bg-white w-full max-w-sm rounded-xl p-6 shadow-2xl">
                                <h3 className="font-serif font-bold text-lg mb-4">Thêm sự kiện</h3>
                                <div className="space-y-3">
                                    <input type="date" className="w-full border p-2 rounded text-sm font-sans" value={newEvent.date} onChange={e => setNewEvent({...newEvent, date: e.target.value})} />
                                    <input type="text" className="w-full border p-2 rounded text-sm font-sans" placeholder="Nội dung..." value={newEvent.title} onChange={e => setNewEvent({...newEvent, title: e.target.value})} />
                                    <div className="flex gap-2 pt-2"><button onClick={() => setIsAddModalOpen(false)} className="flex-1 py-2 border rounded text-sm hover:bg-slate-50">Hủy</button><button onClick={() => { if(!newEvent.title || !newEvent.date) return; setCustomEvents([...customEvents, { id: 'c-'+Date.now(), date: newEvent.date, title: newEvent.title, category: 'personal' }]); setIsAddModalOpen(false); setNewEvent({ date: '', title: '' }); }} className="flex-1 py-2 bg-[#005F40] text-white rounded text-sm hover:bg-[#004d34]">Lưu</button></div>
                                </div>
                            </div>
                        </div>
                    )}
                    {isHelpOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm p-4 no-print" onClick={() => setIsHelpOpen(false)}>
                            <div className="bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden p-6" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-6 border-b border-slate-100 pb-4"><div className="flex items-center gap-3"><div className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-600"><Icons.Help /></div><div><h2 className="font-serif font-bold text-xl text-slate-800">Hướng dẫn sử dụng</h2><p className="text-xs text-slate-400">BSC Analyst Planner</p></div></div><button onClick={() => setIsHelpOpen(false)} className="text-slate-400 hover:text-slate-800"><Icons.X /></button></div>
                                <div className="space-y-6 overflow-y-auto max-h-[60vh] pr-2">
                                    <div><h3 className="font-bold text-sm text-slate-800 mb-2 uppercase tracking-wider">1. Ý nghĩa màu sắc (Badges)</h3><div className="grid grid-cols-2 gap-2 text-xs"><div className="flex items-center gap-2 p-2 bg-rose-50 rounded border border-rose-100"><div className="w-3 h-3 rounded-full bg-rose-500"></div><span>Lễ Tết / Sự kiện nghỉ</span></div><div className="flex items-center gap-2 p-2 bg-indigo-50 rounded border border-indigo-100"><div className="w-3 h-3 rounded-full bg-indigo-500"></div><span>Vĩ mô Thế giới (FED/ECB)</span></div><div className="flex items-center gap-2 p-2 bg-emerald-50 rounded border border-emerald-100"><div className="w-3 h-3 rounded-full bg-emerald-500"></div><span>Vĩ mô VN (GDP/CPI)</span></div><div className="flex items-center gap-2 p-2 bg-amber-50 rounded border border-amber-100"><div className="w-3 h-3 rounded-full bg-amber-500"></div><span>Phái sinh (Đáo hạn)</span></div><div className="flex items-center gap-2 p-2 bg-slate-50 rounded border border-slate-100"><div className="w-3 h-3 rounded-full bg-slate-500"></div><span>ETF (Review/Cut-off)</span></div><div className="flex items-center gap-2 p-2 bg-sky-50 rounded border border-sky-100"><div className="w-3 h-3 rounded-full bg-sky-500"></div><span>Cá nhân (Bạn tự thêm)</span></div><div className="flex items-center gap-2 p-2 bg-yellow-50 rounded border border-yellow-100"><div className="w-3 h-3 rounded-full bg-bsc-gold"></div><span>Ngày <span className="font-bold">Mùng 1 & Rằm</span> (Âm lịch)</span></div></div></div>
                                    <div><h3 className="font-bold text-sm text-slate-800 mb-2 uppercase tracking-wider">2. Quản lý dữ liệu & Note</h3><ul className="text-sm text-slate-600 space-y-2 list-disc pl-4"><li><b>Filter:</b> Bấm vào các viên thuốc (Pills) trên đầu lịch để ẩn/hiện từng loại sự kiện.</li><li><b>Backup/Restore:</b> Dùng để lưu dữ liệu khi chuyển máy (File JSON).</li><li><b>In ấn (Print):</b> Tự động ẩn thanh công cụ, các ô Note sẽ có **ô vuông để bạn tích bút bi vào**.</li><li><b>Xóa Sự kiện:</b> Chỉ có thể xóa các sự kiện có tag **Cá nhân** (Personal) trong Modal Chi tiết.</li></ul></div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
